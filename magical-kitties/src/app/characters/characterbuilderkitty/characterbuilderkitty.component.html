<div class="flex items-baseline">
    <div class="flex flex-col">
        <span class="text-xl font-semibold">Character Level: {{ character?.level }}</span>
    </div>
    <div class="ml-auto">
        <span class="mr-2 font-semibold">XP</span>
        <mat-form-field
            class="max-w-24"
            appearance="outline"
        >
            <input
                matInput
                type="number"
                min="0"
                [formControl]="xpControl"
                (blur)="updateXP(getValue($event))"
            />
        </mat-form-field>
    </div>
    <div class="ml-8">
        <span class="mr-2 font-semibold">Level</span>
        <mat-form-field
            class="max-w-20"
            appearance="outline"
        >
            <mat-select
                [formControl]="levelControl"
                (selectionChange)="updateLevel($event)"
            >
                <mat-option
                    *ngFor="let item of levelOptions"
                    [value]="item"
                >
                    {{ item }}
                </mat-option>
            </mat-select>
        </mat-form-field>
    </div>
</div>
<div>
    <mat-divider class="editor"></mat-divider>
</div>
<div class="flex justify-around mt-4">
    <div class="flex flex-col">
        <span class="ml-auto mr-auto text-xl font-semibold">Cute</span>
        <mat-form-field
            class="mt-1 max-w-28"
            appearance="outline"
        >
            <mat-select [formControl]="cuteControl">
                <mat-option [value]="0">-</mat-option>
                <mat-option
                    *ngFor="let item of statArray"
                    [class.hide]="isFiltered(item)"
                    [value]="item"
                    >{{ item }}</mat-option
                >
            </mat-select>
        </mat-form-field>
    </div>
    <div class="flex flex-col">
        <span class="ml-auto mr-auto text-xl font-semibold">Cunning</span>
        <mat-form-field
            class="mt-1 max-w-28"
            appearance="outline"
        >
            <mat-select [formControl]="cunningControl">
                <mat-option [value]="0">-</mat-option>
                <mat-option
                    *ngFor="let item of statArray"
                    [value]="item"
                    [class.hide]="isFiltered(item)"
                    >{{ item }}</mat-option
                >
            </mat-select>
        </mat-form-field>
    </div>
    <div class="flex flex-col">
        <span class="ml-auto mr-auto text-xl font-semibold">Fierce</span>
        <mat-form-field
            class="mt-1 max-w-28"
            appearance="outline"
        >
            <mat-select [formControl]="fierceControl">
                <mat-option [value]="0">-</mat-option>
                <mat-option
                    *ngFor="let item of statArray"
                    [value]="item"
                    [class.hide]="isFiltered(item)"
                    >{{ item }}</mat-option
                >
            </mat-select>
        </mat-form-field>
    </div>
</div>
<div class="flex items-baseline mt-4">
    <mat-card
        class="min-w-full"
        appearance="outlined"
    >
        <mat-card-header>
            <span class="text-xl font-semibold mb-2">Flaw</span>
            <mat-icon
                class="ml-auto cursor-pointer"
                (click)="openInfoDialog(characterApi.rules?.flaws)"
                >help</mat-icon
            >
        </mat-card-header>
        <mat-card-content>
            <div class="flex">
                <mat-form-field
                    appearance="outline"
                    class="w-1/3"
                >
                    <mat-select
                        [formControl]="flawControl"
                        (selectionChange)="updateFlaw($event)"
                    >
                        <mat-option
                            *ngFor="let flaw of characterApi.rules?.flaws"
                            [value]="flaw.id"
                        >
                            {{ flaw.name }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <markdown
                    class="max-w-1/2 wrap-normal ml-auto"
                    [data]="getFlawDescription(flawControl.value)"
                >
                </markdown>
            </div>
        </mat-card-content>
    </mat-card>
</div>
<div class="flex items-baseline mt-4">
    <mat-card
        class="min-w-full"
        appearance="outlined"
    >
        <mat-card-header>
            <span class="text-xl font-semibold mb-2">Talent</span>
            <mat-icon
                class="ml-auto cursor-pointer"
                (click)="openInfoDialog(characterApi.rules?.talents)"
                >help</mat-icon
            >
        </mat-card-header>
        <mat-card-content>
            <div class="flex">
                <mat-form-field
                    appearance="outline"
                    class="w-1/3"
                >
                    <mat-select
                        [formControl]="talentControl"
                        (selectionChange)="updateTalent($event)"
                    >
                        <mat-option
                            *ngFor="let talent of characterApi.rules?.talents"
                            [value]="talent.id"
                        >
                            {{ talent.name }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <markdown
                    class="max-w-1/2 wrap-normal ml-auto"
                    [data]="getTalentDescription(talentControl.value)"
                >
                </markdown>
            </div>
        </mat-card-content>
    </mat-card>
</div>
<div class="flex items-baseline mt-4 mb-4">
    <mat-card
        class="min-w-full"
        appearance="outlined"
    >
        <mat-card-header>
            <span class="text-xl font-semibold mb-2">Magical Power</span>
            <mat-icon
                class="ml-auto cursor-pointer"
                (click)="openInfoDialog(characterApi.rules?.magicalPowers)"
                >help</mat-icon
            >
        </mat-card-header>
        <mat-card-content class="h-40">
            <div class="flex">
                <div class="w-1/3">
                    <mat-form-field appearance="outline">
                        <mat-select
                            [formControl]="magicalPowerControl"
                            (selectionChange)="updateMagicalPower($event)"
                        >
                            <mat-option
                                *ngFor="let magicalPower of characterApi.rules?.magicalPowers"
                                [value]="magicalPower.id"
                            >
                                {{ magicalPower.name }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="w-1/2 ml-auto max-h-36 overflow-auto">
                    <markdown [data]="getMagicalPowerDescription(magicalPowerControl.value)"> </markdown>
                </div>
            </div>
        </mat-card-content>
    </mat-card>
</div>
<div
    class="mb-5"
    *ngIf="character ? character.level > 1 : false"
>
    <div
        class="flex flex-col"
        [formGroup]="selectedUpgrades"
    >
        <mat-label class="font-semibold">Level 2-4</mat-label>
        <div class="flex items-baseline">
            <mat-checkbox
                formControlName="block1magicalpowerbonus"
                (change)="checkChange($event)"
                [value]="getUpgradeIdFromRules(1, 'bonus')!"
            >
            </mat-checkbox>
            <app-bonus-feature
                [id]="getUpgradeIdFromRules(1, 'bonus')"
                [disabled]="block1Bonus.disabled"
                [upgrade]="getUpgradeFromCharacter(getUpgradeIdFromRules(1, 'bonus'))"
                [characterCurrentPowers]="character?.magicalPowers ?? []"
                (upgradeChanged)="upgradeChanged($event)"
            ></app-bonus-feature>
        </div>
        <div>
            <mat-checkbox
                formControlName="block1Attribute"
                (change)="checkChange($event)"
            >
                <mat-select>
                    <mat-option>1</mat-option>
                    <mat-option>2</mat-option>
                </mat-select>
            </mat-checkbox>
        </div>
    </div>
</div>
<!-- <div
    class="mb-5"
    *ngIf="character ? character.level < 8 : true"
>
    <mat-accordion>
        <mat-expansion-panel
            hideToggle
            class="max-w-2/3"
        >
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <span class="text-xl font-semibold">Upgrades</span>
                    <mat-icon class="ml-auto">add</mat-icon>
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="flex flex-col">
                <div
                    class="flex flex-col"
                    *ngIf="character ? character.level < 2 : true"
                >
                    <mat-label class="font-semibold">Level 2-4</mat-label>
                    <mat-checkbox
                        [disabled]="true"
                        *ngFor="let item of getBlockRules(1)"
                        >{{ item.value }}</mat-checkbox
                    >
                </div>
                <div
                    class="flex flex-col"
                    *ngIf="character ? character.level < 5 : true"
                >
                    <mat-label class="font-semibold">Level 5-7</mat-label>
                    <mat-checkbox
                        [disabled]="true"
                        *ngFor="let item of getBlockRules(2)"
                        >{{ item.value }}</mat-checkbox
                    >
                </div>
                <div
                    class="flex flex-col"
                    *ngIf="character ? character.level < 8 : true"
                >
                    <mat-label class="font-semibold">Level 8-10</mat-label>
                    <mat-checkbox
                        [disabled]="true"
                        *ngFor="let item of getBlockRules(3)"
                        >{{ item.value }}</mat-checkbox
                    >
                </div>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
</div> -->
